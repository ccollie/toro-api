Code derived from Redwood cells
